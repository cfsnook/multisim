<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.commands">
      <category
            id="ac.soton.rms.ui.commands"
            name="RMS UI Commands">
      </category>
      <command
            categoryId="ac.soton.rms.ui.commands"
            id="ac.soton.rms.ui.commands.simulate"
            name="Simulate">
         <commandParameter
               id="ac.soton.rms.ui.parameters.checkInvariants"
               name="Invariants"
               optional="true">
         </commandParameter>
         <commandParameter
               id="ac.soton.rms.ui.parameters.recordTrace"
               name="Record Trace"
               optional="true">
         </commandParameter>
         <commandParameter
               id="ac.soton.rms.ui.parameters.compareTrace"
               name="Compare Trace"
               optional="true">
         </commandParameter>
      </command>
      <command
            categoryId="ac.soton.rms.ui.commands"
            id="ac.soton.rms.ui.commands.pause"
            name="Pause">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.eclipse.ui.main.toolbar">
         <toolbar
               id="ac.soton.rms.ui.toolbar"
               label="RMS Toolbar">
            <command
                  commandId="ac.soton.rms.ui.commands.simulate"
                  icon="icons/Simulate.gif"
                  id="ac.soton.rms.ui.commands.toolbar.simulate"
                  label="Simulate"
                  style="pulldown">
               <visibleWhen
                     checkEnabled="false">
                  <with
                        variable="activePartId">
                     <equals
                           value="ac.soton.rms.components.diagram.part.ComponentsDiagramEditorID">
                     </equals>
                  </with>
               </visibleWhen>
            </command>
            <command
                  commandId="ac.soton.rms.ui.commands.pause"
                  icon="icons/Pause.gif"
                  label="Pause"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <with
                        variable="activePartId">
                     <equals
                           value="ac.soton.rms.components.diagram.part.ComponentsDiagramEditorID">
                     </equals>
                  </with>
               </visibleWhen>
            </command>
         </toolbar>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="menu:ac.soton.rms.ui.commands.toolbar.simulate">
         <command
               commandId="ac.soton.rms.ui.commands.simulate"
               label="Simulate"
               style="push">
         </command>
         <command
               commandId="ac.soton.rms.ui.commands.simulate"
               label="Record Trace"
               style="push">
            <parameter
                  name="ac.soton.rms.ui.parameters.recordTrace"
                  value="true">
            </parameter>
         </command>
         <command
               commandId="ac.soton.rms.ui.commands.simulate"
               label="Compare Trace"
               style="push">
            <parameter
                  name="ac.soton.rms.ui.parameters.compareTrace"
                  value="true">
            </parameter>
         </command>
         <command
               commandId="ac.soton.rms.ui.commands.simulate"
               label="Check Invariants"
               style="push">
            <parameter
                  name="ac.soton.rms.ui.parameters.checkInvariants"
                  value="true">
            </parameter>
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="ac.soton.rms.ui.commands.SimulateCommand"
            commandId="ac.soton.rms.ui.commands.simulate">
         <activeWhen>
            <with
                  variable="ac.soton.rms.ui.commands.simulation.active">
               <equals
                     value="INACTIVE">
               </equals>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="ac.soton.rms.ui.commands.PauseCommand"
            commandId="ac.soton.rms.ui.commands.pause">
         <activeWhen>
            <with
                  variable="ac.soton.rms.ui.commands.simulation.active">
               <equals
                     value="ACTIVE">
               </equals>
            </with></activeWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <sourceProvider
            provider="ac.soton.rms.ui.commands.SimulationState">
         <variable
               name="ac.soton.rms.ui.commands.simulation.active"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
   </extension>

</plugin>
